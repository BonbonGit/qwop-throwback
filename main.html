<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>QWOP-Throwback</title>
    <link rel="stylesheet" href="main.css">
    <script type="text/javascript">
      var canvas;
      var ctx;
      var then;
      var now;
      class GObject{
        constructor(width=10, height=10, x=0, y=0, angle=0){
          this.width = width;
          this.height = height;
          this.x = x;
          this.y = y;
          this.angle = angle;
          this.xSpeed = 0;
          this.ySpeed = 0;
          this.rotSpeed = 0;
        }
        accelerate(xAcc, yAcc, rotAcc){
          this.xSpeed += xAcc * Game.tSLF;
          this.ySpeed += yAcc * Game.tSLF;
          this.rotSpeed += rotAcc * Game.tSLF;
        }
        updatePos(){
          this.x += this.xSpeed * Game.tSLF;
          this.y += this.ySpeed * Game.tSLF;
          this.angle += this.rotSpeed * Game.tSLF;
        }

      }
      class GColorObject extends GObject{
        constructor(width=10, height=10, x=0, y=0, angle=0, color='red'){
          super(width, height, x, y, angle)
          this.color = color;
        }
        render(){
          ctx.fillStyle = this.color;

          ctx.save();
            ctx.translate(this.x, this.y);
            ctx.rotate(this.angle);
            ctx.fillRect(-this.width/2, -this.height/2, this.width, this.height);
          ctx.restore();

        }
      }


      var Game = {
        //time since last frame
        tSLF:0,
        gravity:10, //gravitational acceleration in px/sec
        blueSquare: new GColorObject(20, 20, 10, 10, 0, 'blue'),
        update: function(){
          this.blueSquare.accelerate(0, this.gravity, 0);
          this.blueSquare.updatePos();
        },
        render: function(){
          ctx.clearRect(0,0,canvas.width,canvas.height);
          this.blueSquare.render();
        }

      }
      function init(){
        canvas = document.getElementById('gameArea');
        ctx = canvas.getContext('2d');
        then = performance.now();
        Game.blueSquare.xSpeed = 10;
        Game.blueSquare.rotSpeed = Math.PI/6;
        main();
      }
      function main() {
        window.requestAnimationFrame( main );
        //time at loop start
        now = performance.now();
        Game.tSLF = (now - then)/1000;
        console.log(Game.tSLF);
        Game.update();
        Game.render();
        then = now;
      }

    </script>
  </head>
  <body onload="init()">
    <canvas id="gameArea" height="400" width="800"></canvas>
  </body>
</html>
